(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61523,       1670]
NotebookOptionsPosition[     57876,       1606]
NotebookOutlinePosition[     58289,       1623]
CellTagsIndexPosition[     58246,       1620]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:793a\:4f8b\:ff1a\:ff08\:4e00\:822c\:4e0d\:8981\:66f4\:6539\:ff09", \
"Chapter",
 CellChangeTimes->{{3.9064335746506376`*^9, 3.906433618233118*^9}, {
   3.9064986473598785`*^9, 3.9064986503296742`*^9}, 3.906501391133816*^9, {
   3.9065014232045927`*^9, 
   3.906501427113188*^9}},ExpressionUUID->"d7ac4796-d7a8-43e8-90a1-\
4ef195f29c3c"],

Cell[CellGroupData[{

Cell["MPO\:ff0cMPS\:4ee5\:53ca\:7f29\:5e76\:ff0c", "Section",
 CellChangeTimes->{
  3.9065014258528433`*^9},ExpressionUUID->"028bb646-c5b0-40b5-926b-\
c97da84cb4c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Leftcaconical", "  ", "=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1", ",", "h"}], "}"}], ",", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", 
               RowBox[{"y1", "+", "h"}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x1", "-", 
                RowBox[{
                 FractionBox["1", "8"], "*", "h"}]}], ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", 
               RowBox[{"y1", "+", 
                RowBox[{
                 FractionBox["1", "8"], "*", "h"}]}]}], "}"}]}], "}"}], 
           "]"}]}], "}"}], "]"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftCaconicalLeg", "[", 
      RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"y1", "+", 
            RowBox[{
             FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "-", 
            RowBox[{"Abs", "[", 
             RowBox[{
              FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], 
          "}"}]}], "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightCaconicalLeg", "[", 
      RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"y1", "+", 
            RowBox[{
             FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "+", 
            RowBox[{"Abs", "[", 
             RowBox[{
              FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], 
          "}"}]}], "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SiteVariation", "[", 
      RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"y1", "+", "h"}]}], "}"}]}], "}"}], "]"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixProductOperator", "[", 
      RowBox[{"x1_", ",", "y1_", ",", "s_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "-", "s"}], ",", 
         RowBox[{"y1", "-", "s"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", "s"}], ",", 
         RowBox[{"y1", "+", "s"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"upleg", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LeftCaconicalLeg", "[", 
         RowBox[{"x", ",", "0", ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "4", ",", "1"}], "}"}]}], "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"botleg", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LeftCaconicalLeg", "[", 
         RowBox[{"x", ",", "2", ",", 
          RowBox[{"-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "4", ",", "1"}], "}"}]}], "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"leftpart", " ", "=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{"upleg", ",", "botleg"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"upleg", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RightCaconicalLeg", "[", 
         RowBox[{"x", ",", "0", ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "6", ",", "10", ",", "1"}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"botleg", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RightCaconicalLeg", "[", 
         RowBox[{"x", ",", "2", ",", 
          RowBox[{"-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "6", ",", "10", ",", "1"}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rightpart", " ", "=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{"upleg", ",", "botleg"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mpopart", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"MatrixProductOperator", "[", 
        RowBox[{"x", ",", "1", ",", "0.1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "10", ",", "1"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mpopart", " ", "=", " ", 
     RowBox[{"Append", "[", 
      RowBox[{"mpopart", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"11", ",", "1"}], "}"}]}], "}"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", "leftpart", "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"SiteVariation", "[", 
       RowBox[{"5", ",", "2", ",", 
        RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
     RowBox[{"Graphics", "[", "rightpart", "]"}], ",", 
     RowBox[{"Graphics", "[", "mpopart", "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"11", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}], 
     ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"11", ",", "2"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.906416733919811*^9, 3.9064167550308695`*^9}, {
   3.906416791755332*^9, 3.9064168163650746`*^9}, {3.906416852159671*^9, 
   3.9064168817991157`*^9}, {3.906417077360964*^9, 3.9064170824071965`*^9}, {
   3.9064171426175165`*^9, 3.90641719820963*^9}, {3.906417232553499*^9, 
   3.9064172357737384`*^9}, {3.9064176802597504`*^9, 
   3.9064176956916184`*^9}, {3.906417826877877*^9, 3.9064179530467587`*^9}, {
   3.9064180120495024`*^9, 3.9064180239332256`*^9}, {3.9064184750166216`*^9, 
   3.9064185313113294`*^9}, {3.906418612159952*^9, 3.9064187806935945`*^9}, {
   3.9064294086443644`*^9, 3.906429470174696*^9}, {3.90642969361582*^9, 
   3.9064296989584737`*^9}, {3.9064297633751125`*^9, 
   3.9064298339390154`*^9}, {3.906429874805954*^9, 3.906429878665186*^9}, {
   3.906430068686056*^9, 3.9064300754042873`*^9}, 3.9064301351915817`*^9, {
   3.90643018369249*^9, 3.9064303528439674`*^9}, {3.906430386770014*^9, 
   3.906431116714389*^9}, {3.906431159948191*^9, 3.906431190068083*^9}, {
   3.9064312474768906`*^9, 3.9064313033182325`*^9}, {3.9064314289865384`*^9, 
   3.9064316312845206`*^9}, {3.906431919443658*^9, 3.9064319276540794`*^9}, {
   3.90643205532528*^9, 3.9064320737331796`*^9}, {3.90643223314655*^9, 
   3.9064323304483943`*^9}, {3.9064325195566564`*^9, 
   3.9064325792604933`*^9}, {3.9064326450266623`*^9, 
   3.9064326535432463`*^9}, {3.9064327139458895`*^9, 
   3.9064327427710943`*^9}, {3.906432940943765*^9, 3.9064329629985013`*^9}, {
   3.9064329968351088`*^9, 3.906433169733511*^9}, {3.9064332330296264`*^9, 
   3.906433288614236*^9}, {3.906433625403141*^9, 3.9064336267429805`*^9}, {
   3.9064986555502777`*^9, 3.9064987064540586`*^9}, {3.9064987810204997`*^9, 
   3.9064988483523283`*^9}, {3.906498897024377*^9, 3.9064989025059595`*^9}, {
   3.906498950608118*^9, 3.90649907175404*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"c1b1fe82-e556-4abe-b734-2e43c038ab64"],

Cell[BoxData[
 GraphicsBox[{{
    LineBox[NCache[{{0, 0}, {0, 1}, {0, Rational[1, 8]}, {
       Rational[-1, 8], 0}}, {{0, 0}, {0, 1}, {0, 0.125}, {-0.125, 0}}]], 
    LineBox[NCache[{{1, 0}, {1, 1}, {1, Rational[1, 8]}, {
       Rational[7, 8], 0}}, {{1, 0}, {1, 1}, {1, 0.125}, {0.875, 0}}]], 
    LineBox[NCache[{{2, 0}, {2, 1}, {2, Rational[1, 8]}, {
       Rational[15, 8], 0}}, {{2, 0}, {2, 1}, {2, 0.125}, {1.875, 0}}]], 
    LineBox[NCache[{{3, 0}, {3, 1}, {3, Rational[1, 8]}, {
       Rational[23, 8], 0}}, {{3, 0}, {3, 1}, {3, 0.125}, {2.875, 0}}]], 
    LineBox[NCache[{{4, 0}, {4, 1}, {4, Rational[1, 8]}, {
       Rational[31, 8], 0}}, {{4, 0}, {4, 1}, {4, 0.125}, {3.875, 0}}]], 
    LineBox[NCache[{{0, 2}, {0, 1}, {0, Rational[15, 8]}, {
       Rational[-1, 8], 2}}, {{0, 2}, {0, 1}, {0, 1.875}, {-0.125, 2}}]], 
    LineBox[NCache[{{1, 2}, {1, 1}, {1, Rational[15, 8]}, {
       Rational[7, 8], 2}}, {{1, 2}, {1, 1}, {1, 1.875}, {0.875, 2}}]], 
    LineBox[NCache[{{2, 2}, {2, 1}, {2, Rational[15, 8]}, {
       Rational[15, 8], 2}}, {{2, 2}, {2, 1}, {2, 1.875}, {1.875, 2}}]], 
    LineBox[NCache[{{3, 2}, {3, 1}, {3, Rational[15, 8]}, {
       Rational[23, 8], 2}}, {{3, 2}, {3, 1}, {3, 1.875}, {2.875, 2}}]], 
    LineBox[NCache[{{4, 2}, {4, 1}, {4, Rational[15, 8]}, {
       Rational[31, 8], 2}}, {{4, 2}, {4, 1}, {4, 1.875}, {3.875, 2}}]]}, 
   LineBox[{{5, 2}, {5, 0}}], {
    LineBox[NCache[{{6, 0}, {6, 1}, {6, Rational[1, 8]}, {
       Rational[49, 8], 0}}, {{6, 0}, {6, 1}, {6, 0.125}, {6.125, 0}}]], 
    LineBox[NCache[{{7, 0}, {7, 1}, {7, Rational[1, 8]}, {
       Rational[57, 8], 0}}, {{7, 0}, {7, 1}, {7, 0.125}, {7.125, 0}}]], 
    LineBox[NCache[{{8, 0}, {8, 1}, {8, Rational[1, 8]}, {
       Rational[65, 8], 0}}, {{8, 0}, {8, 1}, {8, 0.125}, {8.125, 0}}]], 
    LineBox[NCache[{{9, 0}, {9, 1}, {9, Rational[1, 8]}, {
       Rational[73, 8], 0}}, {{9, 0}, {9, 1}, {9, 0.125}, {9.125, 0}}]], 
    LineBox[NCache[{{10, 0}, {10, 1}, {10, Rational[1, 8]}, {
       Rational[81, 8], 0}}, {{10, 0}, {10, 1}, {10, 0.125}, {10.125, 0}}]], 
    LineBox[NCache[{{6, 2}, {6, 1}, {6, Rational[15, 8]}, {
       Rational[49, 8], 2}}, {{6, 2}, {6, 1}, {6, 1.875}, {6.125, 2}}]], 
    LineBox[NCache[{{7, 2}, {7, 1}, {7, Rational[15, 8]}, {
       Rational[57, 8], 2}}, {{7, 2}, {7, 1}, {7, 1.875}, {7.125, 2}}]], 
    LineBox[NCache[{{8, 2}, {8, 1}, {8, Rational[15, 8]}, {
       Rational[65, 8], 2}}, {{8, 2}, {8, 1}, {8, 1.875}, {8.125, 2}}]], 
    LineBox[NCache[{{9, 2}, {9, 1}, {9, Rational[15, 8]}, {
       Rational[73, 8], 2}}, {{9, 2}, {9, 1}, {9, 1.875}, {9.125, 2}}]], 
    LineBox[NCache[{{10, 2}, {10, 1}, {10, Rational[15, 8]}, {
       Rational[81, 8], 2}}, {{10, 2}, {10, 1}, {10, 1.875}, {
       10.125, 2}}]]}, {RectangleBox[{-0.1, 0.9}, {0.1, 1.1}], 
    RectangleBox[{0.9, 0.9}, {1.1, 1.1}], 
    RectangleBox[{1.9, 0.9}, {2.1, 1.1}], 
    RectangleBox[{2.9, 0.9}, {3.1, 1.1}], 
    RectangleBox[{3.9, 0.9}, {4.1, 1.1}], 
    RectangleBox[{4.9, 0.9}, {5.1, 1.1}], 
    RectangleBox[{5.9, 0.9}, {6.1, 1.1}], 
    RectangleBox[{6.9, 0.9}, {7.1, 1.1}], 
    RectangleBox[{7.9, 0.9}, {8.1, 1.1}], 
    RectangleBox[{8.9, 0.9}, {9.1, 1.1}], 
    RectangleBox[{9.9, 0.9}, {10.1, 1.1}], LineBox[{{-1, 1}, {11, 1}}]}, 
   {Thickness[0.005], LineBox[{{-1, 0}, {11, 0}}]}, 
   {Thickness[0.005], LineBox[{{-1, 2}, {11, 2}}]}}]], "Output",
 CellChangeTimes->{
  3.906432949620489*^9, {3.9064330232412066`*^9, 3.906433083367673*^9}, 
   3.9064331286513414`*^9, 3.9064331742668304`*^9, {3.9064332469011803`*^9, 
   3.9064332894741154`*^9}, {3.906498786430909*^9, 3.90649881456254*^9}, 
   3.9064989033337255`*^9, {3.906498977626097*^9, 3.9064989811448345`*^9}, {
   3.9064990436250687`*^9, 3.90649907227852*^9}},
 CellLabel->"Out[80]=",ExpressionUUID->"f0f83f93-5e36-45e6-b452-43ba390cdde8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:5355\:4e2atensor\:ff0c\:4ee5\:53ca\:5c11\:91cf\:7684\:7ec4\:5408", \
"Section",
 CellChangeTimes->{{3.9065014347405167`*^9, 3.906501452519535*^9}, {
  3.906501562747964*^9, 
  3.906501571848459*^9}},ExpressionUUID->"0c9017a3-8717-4933-bf3e-\
13c5551aa42e"],

Cell[BoxData[{
 RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftCaconicalLeg", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
   RowBox[{"{", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", 
          RowBox[{
           FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "-", 
          RowBox[{"Abs", "[", 
           RowBox[{
            FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], "}"}]}], 
      "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightCaconicalLeg", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
   RowBox[{"{", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", 
          RowBox[{
           FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", 
          RowBox[{"Abs", "[", 
           RowBox[{
            FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], "}"}]}], 
      "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{"LeftCaconicalLeg", "[", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"LeftCaconicalLeg", "[", 
     RowBox[{"1", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{"RightCaconicalLeg", "[", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"RightCaconicalLeg", "[", 
     RowBox[{"1", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.906501460526553*^9, 3.906501555355737*^9}, {
  3.906501815196849*^9, 3.9065018620286765`*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"02b8a337-ebaa-4191-8f4d-35ecd3945f13"],

Cell[BoxData[
 GraphicsBox[{
   LineBox[NCache[{{0, 0}, {0, -1}, {0, Rational[-1, 8]}, {
      Rational[-1, 8], 0}}, {{0, 0}, {0, -1}, {0, -0.125}, {-0.125, 0}}]], 
   LineBox[NCache[{{1, 0}, {1, -1}, {1, Rational[-1, 8]}, {
      Rational[7, 8], 0}}, {{1, 0}, {1, -1}, {1, -0.125}, {0.875, 0}}]], 
   {Thickness[0.005], LineBox[{{-1, 0}, {2, 0}}]}}]], "Input",
 CellChangeTimes->{{3.906502240408903*^9, 
  3.906502262891708*^9}},ExpressionUUID->"b601c385-ff8e-4b24-a3ae-\
9bf08d72c161"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906502238490057*^9, 
  3.9065022548497343`*^9}},ExpressionUUID->"d49de05d-24a3-4ef3-887f-\
f83a8e4f77b2"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    LineBox[NCache[{{0, 0}, {0, -1}, {0, Rational[-1, 8]}, {
       Rational[1, 8], 0}}, {{0, 0}, {0, -1}, {0, -0.125}, {0.125, 0}}]], 
    LineBox[NCache[{{1, 0}, {1, -1}, {1, Rational[-1, 8]}, {
       Rational[9, 8], 0}}, {{1, 0}, {1, -1}, {1, -0.125}, {1.125, 0}}]], 
    {Thickness[0.005], LineBox[{{-1, 0}, {2, 0}}]}}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.906502239534005*^9, 
  3.906502239534005*^9}},ExpressionUUID->"e08941d9-6295-442a-ab7c-\
2f02f6a3ae94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MatrixProductOperator", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "s_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "-", "s"}], ",", 
       RowBox[{"y1", "-", "s"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "+", "s"}], ",", 
       RowBox[{"y1", "+", "s"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{"MatrixProductOperator", "[", 
     RowBox[{"0", ",", "0", ",", "0.1"}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"MatrixProductOperator", "[", 
     RowBox[{"1", ",", "0", ",", "0.1"}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}]}], "}"}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9065016150633636`*^9, 3.9065017274325285`*^9}},
 CellLabel->
  "In[380]:=",ExpressionUUID->"b53047fd-505e-43db-a0ac-cf42c87abff1"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{RectangleBox[{-0.1, -0.1}, {0.1, 0.1}], 
    RectangleBox[{0.9, -0.1}, {1.1, 0.1}], LineBox[{{-1, 0}, {2, 0}}], 
    LineBox[{{0, 1}, {0, -1}}], LineBox[{{1, 1}, {1, -1}}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9065022372307158`*^9, 
  3.9065022372307158`*^9}},ExpressionUUID->"cc94495f-f3de-470f-bc13-\
8349d18b1aa2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MatrixProductOperator", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "s_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "-", "s"}], ",", 
       RowBox[{"y1", "-", "s"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "+", "s"}], ",", 
       RowBox[{"y1", "+", "s"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{"MatrixProductOperator", "[", 
     RowBox[{"0", ",", "0", ",", "0.1"}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"MatrixProductOperator", "[", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1"}], ",", "0.1"}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "2"}]}], "}"}]}], "}"}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.906501749125013*^9, 3.9065017974148045`*^9}},
 CellLabel->
  "In[384]:=",ExpressionUUID->"aef82119-d2e0-47ab-90fc-b8a360a19743"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{RectangleBox[{-0.1, -0.1}, {0.1, 0.1}], 
    RectangleBox[{-0.1, -1.1}, {0.1, -0.9}], LineBox[{{0, 1}, {0, -2}}], 
    LineBox[{{-1, 0}, {1, 0}}], LineBox[{{-1, -1}, {1, -1}}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9065022345495863`*^9, 
  3.9065022345495863`*^9}},ExpressionUUID->"4206ad21-85c6-4bc9-b19d-\
6039e51918d6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:5de5\:4f5c\:533a", "Chapter",
 CellChangeTimes->{{3.9064336569422626`*^9, 
  3.9064336576403885`*^9}},ExpressionUUID->"82dbd0b9-c253-4fc2-a92f-\
cdec1bf47bd2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Leftcaconical", "  ", "=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1", ",", "h"}], "}"}], ",", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", 
               RowBox[{"y1", "+", "h"}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x1", "-", 
                RowBox[{
                 FractionBox["1", "8"], "*", "h"}]}], ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", 
               RowBox[{"y1", "+", 
                RowBox[{
                 FractionBox["1", "8"], "*", "h"}]}]}], "}"}]}], "}"}], 
           "]"}]}], "}"}], "]"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeftCaconicalLeg", "[", 
      RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"y1", "+", 
            RowBox[{
             FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "-", 
            RowBox[{"Abs", "[", 
             RowBox[{
              FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], 
          "}"}]}], "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightCaconicalLeg", "[", 
      RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"y1", "+", 
            RowBox[{
             FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "+", 
            RowBox[{"Abs", "[", 
             RowBox[{
              FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], 
          "}"}]}], "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixProductOperator", "[", 
      RowBox[{"x1_", ",", "y1_", ",", "s_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "-", "s"}], ",", 
         RowBox[{"y1", "-", "s"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", "s"}], ",", 
         RowBox[{"y1", "+", "s"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"upleg", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LeftCaconicalLeg", "[", 
         RowBox[{"x", ",", "0", ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "3", ",", "1"}], "}"}]}], "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"botleg", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LeftCaconicalLeg", "[", 
         RowBox[{"x", ",", "2", ",", 
          RowBox[{"-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "3", ",", "1"}], "}"}]}], "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mpopart", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"MatrixProductOperator", "[", 
        RowBox[{"x", ",", "1", ",", "0.1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "3", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mpopart", " ", "=", " ", 
     RowBox[{"Append", "[", 
      RowBox[{"mpopart", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "1"}], "}"}]}], "}"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", "upleg", "]"}], ",", 
     RowBox[{"Graphics", "[", "botleg", "]"}], ",", 
     RowBox[{"Graphics", "[", "mpopart", "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}], 
     ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "2"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.90643369224874*^9, 3.9064337076491265`*^9}},
 CellLabel->
  "In[629]:=",ExpressionUUID->"96c9eff4-c2f9-491c-b0e9-030a6898ec82"],

Cell[BoxData[
 GraphicsBox[{{
    LineBox[NCache[{{0, 0}, {0, 1}, {0, Rational[1, 8]}, {
       Rational[-1, 8], 0}}, {{0, 0}, {0, 1}, {0, 0.125}, {-0.125, 0}}]], 
    LineBox[NCache[{{1, 0}, {1, 1}, {1, Rational[1, 8]}, {
       Rational[7, 8], 0}}, {{1, 0}, {1, 1}, {1, 0.125}, {0.875, 0}}]], 
    LineBox[NCache[{{2, 0}, {2, 1}, {2, Rational[1, 8]}, {
       Rational[15, 8], 0}}, {{2, 0}, {2, 1}, {2, 0.125}, {1.875, 0}}]], 
    LineBox[NCache[{{3, 0}, {3, 1}, {3, Rational[1, 8]}, {
       Rational[23, 8], 0}}, {{3, 0}, {3, 1}, {3, 0.125}, {2.875, 0}}]]}, {
    LineBox[NCache[{{0, 2}, {0, 1}, {0, Rational[15, 8]}, {
       Rational[-1, 8], 2}}, {{0, 2}, {0, 1}, {0, 1.875}, {-0.125, 2}}]], 
    LineBox[NCache[{{1, 2}, {1, 1}, {1, Rational[15, 8]}, {
       Rational[7, 8], 2}}, {{1, 2}, {1, 1}, {1, 1.875}, {0.875, 2}}]], 
    LineBox[NCache[{{2, 2}, {2, 1}, {2, Rational[15, 8]}, {
       Rational[15, 8], 2}}, {{2, 2}, {2, 1}, {2, 1.875}, {1.875, 2}}]], 
    LineBox[NCache[{{3, 2}, {3, 1}, {3, Rational[15, 8]}, {
       Rational[23, 8], 2}}, {{3, 2}, {3, 1}, {3, 1.875}, {2.875, 2}}]]}, {
    RectangleBox[{-0.1, 0.9}, {0.1, 1.1}], 
    RectangleBox[{0.9, 0.9}, {1.1, 1.1}], 
    RectangleBox[{1.9, 0.9}, {2.1, 1.1}], 
    RectangleBox[{2.9, 0.9}, {3.1, 1.1}], LineBox[{{-1, 1}, {4, 1}}]}, 
   {Thickness[0.005], LineBox[{{-1, 0}, {4, 0}}]}, 
   {Thickness[0.005], LineBox[{{-1, 2}, {4, 2}}]}}]], "Output",
 CellChangeTimes->{3.9064337085561347`*^9},
 CellLabel->
  "Out[637]=",ExpressionUUID->"97171b8c-94e4-4d24-a760-eebca0dd70af"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9064329220959644`*^9, 
  3.9064329224108806`*^9}},ExpressionUUID->"4d5beea6-6a7d-4b12-9cb4-\
022acacb49a1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"halflength", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftCaconicalLeg", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
   RowBox[{"{", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", 
          RowBox[{
           FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "-", 
          RowBox[{"Abs", "[", 
           RowBox[{
            FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], "}"}]}], 
      "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightCaconicalLeg", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
   RowBox[{"{", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", 
          RowBox[{
           FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", 
          RowBox[{"Abs", "[", 
           RowBox[{
            FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], "}"}]}], 
      "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SiteVariation", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "h"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixProductOperator", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "s_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "-", "s"}], ",", 
       RowBox[{"y1", "-", "s"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "+", "s"}], ",", 
       RowBox[{"y1", "+", "s"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upleg", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"LeftCaconicalLeg", "[", 
       RowBox[{"x", ",", "0", ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"halflength", "-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"botleg", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"LeftCaconicalLeg", "[", 
       RowBox[{"x", ",", "2", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"halflength", "-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leftpart", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"upleg", ",", "botleg"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upleg", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RightCaconicalLeg", "[", 
       RowBox[{"x", ",", "0", ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"halflength", "+", "1"}], ",", 
        RowBox[{"2", "*", "halflength"}], ",", "1"}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"botleg", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RightCaconicalLeg", "[", 
       RowBox[{"x", ",", "2", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"halflength", "+", "1"}], ",", 
        RowBox[{"2", "*", "halflength"}], ",", "1"}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rightpart", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"upleg", ",", "botleg"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpopart", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MatrixProductOperator", "[", 
      RowBox[{"x", ",", "1", ",", "0.1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"2", "*", "halflength"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpopart", " ", "=", " ", 
   RowBox[{"Append", "[", 
    RowBox[{"mpopart", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "halflength"}], "+", "1"}], ",", "1"}], "}"}]}], 
       "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", "leftpart", "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"SiteVariation", "[", 
     RowBox[{"halflength", ",", "2", ",", 
      RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", "rightpart", "]"}], ",", 
   RowBox[{"Graphics", "[", "mpopart", "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "halflength"}], "+", "1"}], ",", "0"}], "}"}]}],
         "}"}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "halflength"}], "+", "1"}], ",", "2"}], "}"}]}],
         "}"}], "]"}]}], "}"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.906499111856201*^9, 3.9064993035763164`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"db0230a8-30e1-4d16-a936-127d9a8b6cc6"],

Cell[BoxData[
 GraphicsBox[{{
    LineBox[NCache[{{0, 0}, {0, 1}, {0, Rational[1, 8]}, {
       Rational[-1, 8], 0}}, {{0, 0}, {0, 1}, {0, 0.125}, {-0.125, 0}}]], 
    LineBox[NCache[{{1, 0}, {1, 1}, {1, Rational[1, 8]}, {
       Rational[7, 8], 0}}, {{1, 0}, {1, 1}, {1, 0.125}, {0.875, 0}}]], 
    LineBox[NCache[{{2, 0}, {2, 1}, {2, Rational[1, 8]}, {
       Rational[15, 8], 0}}, {{2, 0}, {2, 1}, {2, 0.125}, {1.875, 0}}]], 
    LineBox[NCache[{{0, 2}, {0, 1}, {0, Rational[15, 8]}, {
       Rational[-1, 8], 2}}, {{0, 2}, {0, 1}, {0, 1.875}, {-0.125, 2}}]], 
    LineBox[NCache[{{1, 2}, {1, 1}, {1, Rational[15, 8]}, {
       Rational[7, 8], 2}}, {{1, 2}, {1, 1}, {1, 1.875}, {0.875, 2}}]], 
    LineBox[NCache[{{2, 2}, {2, 1}, {2, Rational[15, 8]}, {
       Rational[15, 8], 2}}, {{2, 2}, {2, 1}, {2, 1.875}, {1.875, 2}}]]}, 
   LineBox[{{3, 2}, {3, 0}}], {
    LineBox[NCache[{{4, 0}, {4, 1}, {4, Rational[1, 8]}, {
       Rational[33, 8], 0}}, {{4, 0}, {4, 1}, {4, 0.125}, {4.125, 0}}]], 
    LineBox[NCache[{{5, 0}, {5, 1}, {5, Rational[1, 8]}, {
       Rational[41, 8], 0}}, {{5, 0}, {5, 1}, {5, 0.125}, {5.125, 0}}]], 
    LineBox[NCache[{{6, 0}, {6, 1}, {6, Rational[1, 8]}, {
       Rational[49, 8], 0}}, {{6, 0}, {6, 1}, {6, 0.125}, {6.125, 0}}]], 
    LineBox[NCache[{{4, 2}, {4, 1}, {4, Rational[15, 8]}, {
       Rational[33, 8], 2}}, {{4, 2}, {4, 1}, {4, 1.875}, {4.125, 2}}]], 
    LineBox[NCache[{{5, 2}, {5, 1}, {5, Rational[15, 8]}, {
       Rational[41, 8], 2}}, {{5, 2}, {5, 1}, {5, 1.875}, {5.125, 2}}]], 
    LineBox[NCache[{{6, 2}, {6, 1}, {6, Rational[15, 8]}, {
       Rational[49, 8], 2}}, {{6, 2}, {6, 1}, {6, 1.875}, {6.125, 2}}]]}, {
    RectangleBox[{-0.1, 0.9}, {0.1, 1.1}], 
    RectangleBox[{0.9, 0.9}, {1.1, 1.1}], 
    RectangleBox[{1.9, 0.9}, {2.1, 1.1}], 
    RectangleBox[{2.9, 0.9}, {3.1, 1.1}], 
    RectangleBox[{3.9, 0.9}, {4.1, 1.1}], 
    RectangleBox[{4.9, 0.9}, {5.1, 1.1}], 
    RectangleBox[{5.9, 0.9}, {6.1, 1.1}], LineBox[{{-1, 1}, {7, 1}}]}, 
   {Thickness[0.005], LineBox[{{-1, 0}, {7, 0}}]}, 
   {Thickness[0.005], LineBox[{{-1, 2}, {7, 2}}]}}]], "Output",
 CellChangeTimes->{{3.9064992617244787`*^9, 3.906499304069694*^9}},
 CellLabel->
  "Out[125]=",ExpressionUUID->"abc1032a-5e1b-407f-85cb-721d13f083f9"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9064177370665894`*^9, 3.9064177370665894`*^9}, {
   3.9064327723177032`*^9, 3.906432787539859*^9}, {3.9064328178681555`*^9, 
   3.9064328780550904`*^9}, 
   3.906432921429443*^9},ExpressionUUID->"f1058b4c-ba99-4dc9-9d84-\
ffaf4b522786"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906432356989843*^9, 3.906432359907019*^9}, 
   3.906433055903813*^9},ExpressionUUID->"e32954ea-b321-4701-a059-\
942a9051eeb5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906432361854802*^9, 3.906432382675969*^9}, 
   3.906498495870703*^9},ExpressionUUID->"8185e942-fa4f-4092-905c-\
185415cd8084"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"halflength", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftCaconicalLeg", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
   RowBox[{"{", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", 
          RowBox[{
           FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "-", 
          RowBox[{"Abs", "[", 
           RowBox[{
            FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], "}"}]}], 
      "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightCaconicalLeg", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
   RowBox[{"{", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", 
          RowBox[{
           FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", 
          RowBox[{"Abs", "[", 
           RowBox[{
            FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], "}"}]}], 
      "}"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SiteVariation", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "h"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixProductOperator", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "s_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "-", "s"}], ",", 
       RowBox[{"y1", "-", "s"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "+", "s"}], ",", 
       RowBox[{"y1", "+", "s"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upleg", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"LeftCaconicalLeg", "[", 
       RowBox[{"x", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"halflength", "-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"botleg", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"LeftCaconicalLeg", "[", 
       RowBox[{"x", ",", "2", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"halflength", "-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leftpart", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"upleg", ",", "botleg"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upleg", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RightCaconicalLeg", "[", 
       RowBox[{"x", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"halflength", "+", "1"}], ",", 
        RowBox[{"2", "*", "halflength"}], ",", "1"}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"botleg", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RightCaconicalLeg", "[", 
       RowBox[{"x", ",", "2", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"halflength", "+", "1"}], ",", 
        RowBox[{"2", "*", "halflength"}], ",", "1"}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rightpart", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"upleg", ",", "botleg"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpopart", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MatrixProductOperator", "[", 
      RowBox[{"x", ",", "1", ",", "0.1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"2", "*", "halflength"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpopart", " ", "=", " ", 
   RowBox[{"Append", "[", 
    RowBox[{"mpopart", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "halflength"}], "+", "1"}], ",", "1"}], "}"}]}], 
       "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpopart2", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MatrixProductOperator", "[", 
      RowBox[{"x", ",", "0", ",", "0.1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"2", "*", "halflength"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpopart2", "=", " ", 
   RowBox[{"Append", "[", 
    RowBox[{"mpopart2", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "halflength"}], "+", "1"}], ",", "0"}], "}"}]}], 
       "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"somelines", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"2", "*", "halflength"}], ",", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", "leftpart", "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"SiteVariation", "[", 
     RowBox[{"halflength", ",", "2", ",", 
      RowBox[{"-", "3"}]}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", "mpopart2", "]"}], ",", 
   RowBox[{"Graphics", "[", "rightpart", "]"}], ",", 
   RowBox[{"Graphics", "[", "mpopart", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", "somelines", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "halflength"}], "+", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "halflength"}], "+", "1"}], ",", "2"}], "}"}]}],
         "}"}], "]"}]}], "}"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.906500835399805*^9, 3.9065010664596033`*^9}, {
  3.906501104389778*^9, 3.906501196389019*^9}, {3.9065012295890713`*^9, 
  3.906501276808041*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"f51550d6-7bbd-4ab9-a865-4379c30600dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9065008294316044`*^9, 3.906500885448994*^9}, {
   3.9065009281483107`*^9, 3.9065009414740276`*^9}, {3.9065010082317142`*^9, 
   3.906501067596179*^9}, 3.9065011969691677`*^9, {3.906501244478409*^9, 
   3.9065012772654314`*^9}},
 CellLabel->
  "Out[370]=",ExpressionUUID->"bf5fda3a-d699-48c8-bf52-20c523baccdd"],

Cell[BoxData[
 GraphicsBox[{{
    LineBox[NCache[{{0, -1}, {0, 0}, {0, Rational[-7, 8]}, {
       Rational[-1, 8], -1}}, {{0, -1}, {0, 0}, {0, -0.875}, {-0.125, -1}}]], 
    LineBox[NCache[{{1, -1}, {1, 0}, {1, Rational[-7, 8]}, {
       Rational[7, 8], -1}}, {{1, -1}, {1, 0}, {1, -0.875}, {0.875, -1}}]], 
    LineBox[NCache[{{0, 2}, {0, 1}, {0, Rational[15, 8]}, {
       Rational[-1, 8], 2}}, {{0, 2}, {0, 1}, {0, 1.875}, {-0.125, 2}}]], 
    LineBox[NCache[{{1, 2}, {1, 1}, {1, Rational[15, 8]}, {
       Rational[7, 8], 2}}, {{1, 2}, {1, 1}, {1, 1.875}, {0.875, 2}}]]}, 
   LineBox[{{2, 2}, {2, -1}}], {RectangleBox[{-0.1, -0.1}, {0.1, 0.1}], 
    RectangleBox[{0.9, -0.1}, {1.1, 0.1}], 
    RectangleBox[{1.9, -0.1}, {2.1, 0.1}], 
    RectangleBox[{2.9, -0.1}, {3.1, 0.1}], 
    RectangleBox[{3.9, -0.1}, {4.1, 0.1}], LineBox[{{-1, 0}, {5, 0}}]}, {
    LineBox[NCache[{{3, -1}, {3, 0}, {3, Rational[-7, 8]}, {
       Rational[25, 8], -1}}, {{3, -1}, {3, 0}, {3, -0.875}, {3.125, -1}}]], 
    LineBox[NCache[{{4, -1}, {4, 0}, {4, Rational[-7, 8]}, {
       Rational[33, 8], -1}}, {{4, -1}, {4, 0}, {4, -0.875}, {4.125, -1}}]], 
    LineBox[NCache[{{3, 2}, {3, 1}, {3, Rational[15, 8]}, {
       Rational[25, 8], 2}}, {{3, 2}, {3, 1}, {3, 1.875}, {3.125, 2}}]], 
    LineBox[NCache[{{4, 2}, {4, 1}, {4, Rational[15, 8]}, {
       Rational[33, 8], 2}}, {{4, 2}, {4, 1}, {4, 1.875}, {4.125, 2}}]]}, {
    RectangleBox[{-0.1, 0.9}, {0.1, 1.1}], 
    RectangleBox[{0.9, 0.9}, {1.1, 1.1}], 
    RectangleBox[{1.9, 0.9}, {2.1, 1.1}], 
    RectangleBox[{2.9, 0.9}, {3.1, 1.1}], 
    RectangleBox[{3.9, 0.9}, {4.1, 1.1}], LineBox[{{-1, 1}, {5, 1}}]}, {
    LineBox[{{0, 0}, {0, 1}}], LineBox[{{1, 0}, {1, 1}}], 
    LineBox[{{2, 0}, {2, 1}}], LineBox[{{3, 0}, {3, 1}}], 
    LineBox[{{4, 0}, {4, 1}}]}, 
   {Thickness[0.005], LineBox[{{-1, -1}, {5, -1}}]}, 
   {Thickness[0.005], LineBox[{{-1, 2}, {5, 2}}]}}]], "Output",
 CellChangeTimes->{{3.9065008294316044`*^9, 3.906500885448994*^9}, {
   3.9065009281483107`*^9, 3.9065009414740276`*^9}, {3.9065010082317142`*^9, 
   3.906501067596179*^9}, 3.9065011969691677`*^9, {3.906501244478409*^9, 
   3.9065012772654314`*^9}},
 CellLabel->
  "Out[371]=",ExpressionUUID->"2364a568-eeb5-4f7c-bb40-cace85589aef"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906498527194828*^9, 
  3.906498527194828*^9}},ExpressionUUID->"234cd63b-0773-4412-97f5-\
06a1a01efa73"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightCaconicalLeg", "[", 
     RowBox[{"x1_", ",", "y1_", ",", "h_"}], "]"}], "  ", ":=", 
    RowBox[{"{", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"y1", "+", "h"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"y1", "+", 
           RowBox[{
            FractionBox["1", "8"], "*", "h"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "+", 
           RowBox[{"Abs", "[", 
            RowBox[{
             FractionBox["1", "8"], "*", "h"}], "]"}]}], ",", "y1"}], "}"}]}],
        "}"}], "]"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{"RightCaconicalLeg", "[", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.906502324163101*^9, 3.906502336053127*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"96fde4b4-21bd-4d14-bc2c-c6f2c8546573"],

Cell[BoxData[
 GraphicsBox[{
   LineBox[NCache[{{0, 0}, {0, -1}, {0, Rational[-1, 8]}, {
      Rational[1, 8], 0}}, {{0, 0}, {0, -1}, {0, -0.125}, {0.125, 0}}]], 
   {Thickness[0.005], LineBox[{{-1, 0}, {1, 0}}]}}]], "Output",
 CellChangeTimes->{{3.906502331349084*^9, 3.9065023366901817`*^9}},
 CellLabel->
  "Out[407]=",ExpressionUUID->"9ba10ee0-e00b-4714-a269-6b959c8fefc5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MatrixProductOperator", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "s_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "-", "s"}], ",", 
       RowBox[{"y1", "-", "s"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "+", "s"}], ",", 
       RowBox[{"y1", "+", "s"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{"MatrixProductOperator", "[", 
     RowBox[{"0", ",", "0", ",", "0.1"}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"MatrixProductOperator", "[", 
     RowBox[{"1", ",", "0", ",", "0.1"}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}]}], "}"}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}], "]"}]}], 
  "]"}]}], "Input",ExpressionUUID->"39fc95cf-8f4e-4658-87c2-35111374795a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9064169766654997`*^9, 
  3.9064169911021914`*^9}},ExpressionUUID->"94fce57a-36a3-408c-82a0-\
ecf9f9297cb2"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906416985906913*^9, 
  3.9064169863130293`*^9}},ExpressionUUID->"f65b3ef4-6cd5-4407-897f-\
80dff81b44ec"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9064167543434486`*^9, 
  3.9064167543434486`*^9}},ExpressionUUID->"4fee4d6f-ae8d-4c54-b2b1-\
6e8a2707877e"]
}, Open  ]]
},
WindowSize->{1428, 735.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (2023\:5e746\:67083\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"88d2c705-d6d2-45b9-b866-eb612f959715"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 344, 6, 69, "Chapter",ExpressionUUID->"d7ac4796-d7a8-43e8-90a1-4ef195f29c3c"],
Cell[CellGroupData[{
Cell[949, 32, 165, 3, 67, "Section",ExpressionUUID->"028bb646-c5b0-40b5-926b-c97da84cb4c2"],
Cell[CellGroupData[{
Cell[1139, 39, 9475, 249, 599, "Input",ExpressionUUID->"c1b1fe82-e556-4abe-b734-2e43c038ab64"],
Cell[10617, 290, 3824, 62, 88, "Output",ExpressionUUID->"f0f83f93-5e36-45e6-b452-43ba390cdde8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14490, 358, 264, 5, 67, "Section",ExpressionUUID->"0c9017a3-8717-4933-bf3e-13c5551aa42e"],
Cell[14757, 365, 3312, 101, 222, "Input",ExpressionUUID->"02b8a337-ebaa-4191-8f4d-35ecd3945f13"],
Cell[18072, 468, 487, 9, 142, "Input",ExpressionUUID->"b601c385-ff8e-4b24-a3ae-9bf08d72c161"],
Cell[18562, 479, 154, 3, 28, "Input",ExpressionUUID->"d49de05d-24a3-4ef3-887f-f83a8e4f77b2"],
Cell[18719, 484, 529, 11, 68, "Input",ExpressionUUID->"e08941d9-6295-442a-ab7c-2f02f6a3ae94"],
Cell[19251, 497, 1781, 55, 114, "Input",ExpressionUUID->"b53047fd-505e-43db-a0ac-cf42c87abff1"],
Cell[21035, 554, 381, 8, 100, "Input",ExpressionUUID->"cc94495f-f3de-470f-bc13-8349d18b1aa2"],
Cell[21419, 564, 1851, 58, 114, "Input",ExpressionUUID->"aef82119-d2e0-47ab-90fc-b8a360a19743"],
Cell[23273, 624, 385, 8, 153, "Input",ExpressionUUID->"4206ad21-85c6-4bc9-b19d-6039e51918d6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23707, 638, 167, 3, 69, "Chapter",ExpressionUUID->"82dbd0b9-c253-4fc2-a92f-cdec1bf47bd2"],
Cell[CellGroupData[{
Cell[23899, 645, 6051, 178, 406, "Input",ExpressionUUID->"96c9eff4-c2f9-491c-b0e9-030a6898ec82"],
Cell[29953, 825, 1546, 26, 169, "Output",ExpressionUUID->"97171b8c-94e4-4d24-a760-eebca0dd70af"]
}, Open  ]],
Cell[31514, 854, 156, 3, 28, "Input",ExpressionUUID->"4d5beea6-6a7d-4b12-9cb4-022acacb49a1"],
Cell[CellGroupData[{
Cell[31695, 861, 6791, 205, 594, "Input",ExpressionUUID->"db0230a8-30e1-4d16-a936-127d9a8b6cc6"],
Cell[38489, 1068, 2264, 38, 117, "Output",ExpressionUUID->"abc1032a-5e1b-407f-85cb-721d13f083f9"]
}, Open  ]],
Cell[40768, 1109, 285, 5, 28, "Input",ExpressionUUID->"f1058b4c-ba99-4dc9-9d84-ffaf4b522786"],
Cell[41056, 1116, 175, 3, 28, "Input",ExpressionUUID->"e32954ea-b321-4701-a059-942a9051eeb5"],
Cell[41234, 1121, 175, 3, 28, "Input",ExpressionUUID->"8185e942-fa4f-4092-905c-185415cd8084"],
Cell[CellGroupData[{
Cell[41434, 1128, 8377, 251, 735, "Input",ExpressionUUID->"f51550d6-7bbd-4ab9-a865-4379c30600dc"],
Cell[49814, 1381, 1401, 43, 32, "Output",ExpressionUUID->"bf5fda3a-d699-48c8-bf52-20c523baccdd"],
Cell[51218, 1426, 2251, 38, 203, "Output",ExpressionUUID->"2364a568-eeb5-4f7c-bb40-cace85589aef"]
}, Open  ]],
Cell[53484, 1467, 152, 3, 28, "Input",ExpressionUUID->"234cd63b-0773-4412-97f5-06a1a01efa73"],
Cell[CellGroupData[{
Cell[53661, 1474, 1646, 50, 151, "Input",ExpressionUUID->"96fde4b4-21bd-4d14-bc2c-c6f2c8546573"],
Cell[55310, 1526, 377, 7, 203, "Output",ExpressionUUID->"9ba10ee0-e00b-4714-a269-6b959c8fefc5"]
}, Open  ]],
Cell[55702, 1536, 1683, 52, 114, "Input",ExpressionUUID->"39fc95cf-8f4e-4658-87c2-35111374795a"],
Cell[57388, 1590, 156, 3, 28, "Input",ExpressionUUID->"94fce57a-36a3-408c-82a0-ecf9f9297cb2"],
Cell[57547, 1595, 154, 3, 28, "Input",ExpressionUUID->"f65b3ef4-6cd5-4407-897f-80dff81b44ec"],
Cell[57704, 1600, 156, 3, 28, "Input",ExpressionUUID->"4fee4d6f-ae8d-4c54-b2b1-6e8a2707877e"]
}, Open  ]]
}
]
*)

